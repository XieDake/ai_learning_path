# 风险函数
&emsp;&emsp;风险函数是损失函数的期望，表达平均意义上的模型预测的好坏。

## 经验风险函数
### 经验风险
&emsp;&emsp;**经验风险**是对所有训练样本都求一次损失函数，再累加求平均。即模型 $f(x)$ 对训练样本中所有样本的预测能力。经验风险公式如下：

$$R_{emp}(f)={\frac 1 N} \sum_{i=1}^NL(y_i,f(x_i))$$

### 经验风险最小化
&emsp;&emsp;**经验风险最小化**即对训练集中的所有样本点损失函数的平均最小化。

$$ {\displaystyle {\hat {f}}=\arg \min_{f \in {\mathcal {F}}}R_{\text{emp}}(f)}$$

即：
$${\displaystyle {\hat {f}}=\arg \min_{f \in {\mathcal {F}}}{\frac 1 N} \sum_{i=1}^NL(y_i,f(x_i))}$$

&emsp;&emsp;经验风险越小说明模型 $f(x)$ 对训练集的拟合程度越好。

## 期望风险
&emsp;&emsp;**期望风险**对所有样本的预测能力，是全局概念（包含未知样本和已知的训练样本）。经验风险则是局部概念，仅仅表示决策函数对训练数据集里的样本的预测能力。期望风险公式如下：

$${\displaystyle R_{emp}(f)=\mathbf {E} [L(f(x),Y)]=\int _{x \times y}L(f(x),y)P(x,y)dxdy}$$

&emsp;&emsp;理想的模型（决策）函数应该是让所有的样本的损失函数最小（即期望风险最小化）。但是期望风险函数往往不可得，所以用局部最优代替全局最优。这就是经验风险最小化的理论基础。

总结经验风险和期望风险之间的关系：

- 经验风险是局部的，基于训练集所有样本点损失函数最小化。经验风险是局部最优，是现实的可求的。
- 期望风险是全局的，基于所有样本点损失函数最小化。期望风险是全局最优，是理想化的不可求的。

## 结构风险函数
### 结构风险
&emsp;&emsp;只考虑经验风险的话，会出现过拟合现象，即模型 $f(x)$ 对训练集中所有的样本点都有最好的预测能力，但是对于非训练集中的样本数据，模型的预测能力非常不好。怎么办？这就需要结构风险。

&emsp;&emsp;对经验风险和期望风险的折中，在经验风险函数后面加一个正则化项（惩罚项），它是一个大于0的系数 $\lambda$和表示模型复杂度的 $J(f)$ 组成。

$$R_{srm}(f)={\frac 1 N} \sum_{i=1}^NL(y_i,f(x_i))+\lambda J(f)$$

### 结构风险最小化
&emsp;&emsp;经验风险越小，模型决策函数越复杂，其包含的参数越多，当经验风险函数小到一定程度就出现了过拟合现象。也可以理解为模型决策函数的复杂程度是过拟合的必要条件，那么我们要想防止过拟合现象的方式，就要破坏这个必要条件，即降低模型决策函数的复杂度，也即让惩罚项 $\lambda J(f)$ 最小化。

&emsp;&emsp;现在出现两个需要最小化的函数了。我们需要同时保证经验风险函数和模型决策函数的复杂度都达到最小化，一个简单的办法把两个式子融合成一个式子得到结构风险函数然后对这个结构风险函数进行最小化。

&emsp;&emsp;**结构风险最小化**函数公式表示为：

$$ {\displaystyle {\hat {f}}=\arg \min_{f \in {\mathcal {F}}}R_{\text{srm}}(f)}$$

即：
$${\displaystyle {\hat {f}}=\arg \min_{f \in {\mathcal {F}}}{{\frac 1 N} \sum_{i=1}^NL(y_i,f(x_i))+\lambda J(f)}}$$
